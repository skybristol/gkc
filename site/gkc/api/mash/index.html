
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Data Distillery - A framework for data distillation toward the Global Knowledge Commons">
      
      
      
        <link rel="canonical" href="https://datadistillery.org/gkc/api/mash/">
      
      
        <link rel="prev" href="../auth/">
      
      
        <link rel="next" href="../mash_formatters/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Mash - Data Distillery</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mash-module-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Data Distillery" class="md-header__button md-logo" aria-label="Data Distillery" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Data Distillery
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mash
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/skybristol/gkc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    skybristol/gkc
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Data Distillery" class="md-nav__button md-logo" aria-label="Data Distillery" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Data Distillery
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/skybristol/gkc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    skybristol/gkc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Data Curation Narratives
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data Curation Narratives
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tribes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tribal Governments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../SpiritSafe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpiritSafe
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Architecture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/profile-loading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Profile Loading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/spiritsafe-infrastructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpiritSafe Infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/validation-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Validation Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    GKC Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    GKC Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Background
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../profiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Entity Profiles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup and Orientation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../authentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authentication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data Distillery Workflow
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data Distillery Workflow
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../shipping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Shipping
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" checked>
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authentication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Mash
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Mash
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Start
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wikidataloader" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataLoader
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WikidataLoader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataLoader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.load_entity_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_entity_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.load_entity_schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_entity_schema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.load_item" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_item
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.load_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_items
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.load_property" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_property
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wikidatatemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataTemplate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WikidataTemplate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataTemplate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.filter_languages" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_languages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.filter_properties" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_properties
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.filter_qualifiers" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_qualifiers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.filter_references" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_references
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.to_gkc_entity_profile" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_gkc_entity_profile
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.to_qsv1" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_qsv1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.to_shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_shell
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.to_simple_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_simple_dict
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wikidatapropertytemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataPropertyTemplate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WikidataPropertyTemplate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataPropertyTemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataPropertyTemplate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataPropertyTemplate.filter_languages" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_languages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataPropertyTemplate.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataPropertyTemplate.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataPropertyTemplate.to_gkc_entity_profile" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_gkc_entity_profile
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataPropertyTemplate.to_shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_shell
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wikidataentityschematemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataEntitySchemaTemplate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WikidataEntitySchemaTemplate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataEntitySchemaTemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataEntitySchemaTemplate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataEntitySchemaTemplate.filter_languages" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_languages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataEntitySchemaTemplate.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataEntitySchemaTemplate.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataEntitySchemaTemplate.to_gkc_entity_profile" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_gkc_entity_profile
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataEntitySchemaTemplate.to_shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_shell
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wikipedialoader" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikipediaLoader
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WikipediaLoader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikipediaLoader" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikipediaLoader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikipediaLoader.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikipediaLoader.load_template" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_template
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wikipediatemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikipediaTemplate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WikipediaTemplate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikipediaTemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikipediaTemplate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikipediaTemplate.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikipediaTemplate.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utility-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Utility Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utility Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strip_entity_identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      
        strip_entity_identifiers()
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="strip_entity_identifiers()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.strip_entity_identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      
        strip_entity_identifiers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetch_property_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        fetch_property_labels()
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fetch_property_labels()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.fetch_property_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        fetch_property_labels
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#claimsummary" class="md-nav__link">
    <span class="md-ellipsis">
      
        ClaimSummary
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ClaimSummary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.ClaimSummary" class="md-nav__link">
    <span class="md-ellipsis">
      
        ClaimSummary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load-and-filter-a-wikidata-item" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load and filter a Wikidata item
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-multiple-items-in-batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load multiple items in batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prepare-entity-data-for-new-item-creation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prepare entity data for new item creation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-item-to-quickstatements-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Convert item to QuickStatements format
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-and-work-with-properties" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load and work with properties
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-and-transform-entityschemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load and transform EntitySchemas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetch-descriptors-for-mixed-entities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fetch descriptors for mixed entities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#work-with-multiple-language-versions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Work with multiple language versions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-with-custom-user-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load with custom user agent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-and-examine-a-wikipedia-template" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load and examine a Wikipedia template
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transformation-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Transformation Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transformation Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_shell()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_qsv1-items-only" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_qsv1() (Items only)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_gkc_entity_profile-entityschemas-only" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_gkc_entity_profile() (EntitySchemas only)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Handling
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#entity-not-found" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entity not found
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Network errors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-from-previous-version" class="md-nav__link">
    <span class="md-ellipsis">
      
        Migration from Previous Version
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      
        See Also
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mash_formatters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mash Formatters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../profiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Profiles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spirit_safe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpiritSafe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ShEx
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shipper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Shipper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sparql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SPARQL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Command Line Interface
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Command Line Interface
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/auth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authentication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/mash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mash
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/profiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Profiles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/shex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ShEx
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Utilities and Tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utilities and Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Utilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_9" >
        
          
          <label class="md-nav__link" for="__nav_5_9" id="__nav_5_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CI_CD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CI/CD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../RELEASE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Release Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Start
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wikidataloader" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataLoader
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WikidataLoader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataLoader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.load_entity_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_entity_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.load_entity_schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_entity_schema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.load_item" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_item
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.load_items" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_items
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataLoader.load_property" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_property
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wikidatatemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataTemplate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WikidataTemplate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataTemplate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.filter_languages" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_languages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.filter_properties" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_properties
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.filter_qualifiers" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_qualifiers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.filter_references" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_references
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.to_gkc_entity_profile" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_gkc_entity_profile
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.to_qsv1" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_qsv1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.to_shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_shell
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataTemplate.to_simple_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_simple_dict
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wikidatapropertytemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataPropertyTemplate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WikidataPropertyTemplate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataPropertyTemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataPropertyTemplate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataPropertyTemplate.filter_languages" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_languages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataPropertyTemplate.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataPropertyTemplate.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataPropertyTemplate.to_gkc_entity_profile" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_gkc_entity_profile
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataPropertyTemplate.to_shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_shell
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wikidataentityschematemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataEntitySchemaTemplate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WikidataEntitySchemaTemplate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataEntitySchemaTemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikidataEntitySchemaTemplate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataEntitySchemaTemplate.filter_languages" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_languages
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataEntitySchemaTemplate.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataEntitySchemaTemplate.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataEntitySchemaTemplate.to_gkc_entity_profile" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_gkc_entity_profile
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikidataEntitySchemaTemplate.to_shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_shell
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wikipedialoader" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikipediaLoader
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WikipediaLoader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikipediaLoader" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikipediaLoader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikipediaLoader.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikipediaLoader.load_template" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_template
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wikipediatemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikipediaTemplate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WikipediaTemplate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikipediaTemplate" class="md-nav__link">
    <span class="md-ellipsis">
      
        WikipediaTemplate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikipediaTemplate.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkc.mash.WikipediaTemplate.to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utility-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Utility Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utility Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strip_entity_identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      
        strip_entity_identifiers()
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="strip_entity_identifiers()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.strip_entity_identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      
        strip_entity_identifiers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetch_property_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        fetch_property_labels()
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fetch_property_labels()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.fetch_property_labels" class="md-nav__link">
    <span class="md-ellipsis">
      
        fetch_property_labels
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#claimsummary" class="md-nav__link">
    <span class="md-ellipsis">
      
        ClaimSummary
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ClaimSummary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gkc.mash.ClaimSummary" class="md-nav__link">
    <span class="md-ellipsis">
      
        ClaimSummary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load-and-filter-a-wikidata-item" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load and filter a Wikidata item
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-multiple-items-in-batch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load multiple items in batch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prepare-entity-data-for-new-item-creation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prepare entity data for new item creation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-item-to-quickstatements-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Convert item to QuickStatements format
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-and-work-with-properties" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load and work with properties
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-and-transform-entityschemas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load and transform EntitySchemas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetch-descriptors-for-mixed-entities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fetch descriptors for mixed entities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#work-with-multiple-language-versions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Work with multiple language versions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-with-custom-user-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load with custom user agent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-and-examine-a-wikipedia-template" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load and examine a Wikipedia template
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transformation-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Transformation Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transformation Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#to_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_dict()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_shell" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_shell()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_qsv1-items-only" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_qsv1() (Items only)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_gkc_entity_profile-entityschemas-only" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_gkc_entity_profile() (EntitySchemas only)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Handling
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#entity-not-found" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entity not found
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Network errors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-from-previous-version" class="md-nav__link">
    <span class="md-ellipsis">
      
        Migration from Previous Version
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    <span class="md-ellipsis">
      
        See Also
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="mash-module-api">Mash Module API</h1>
<h2 id="overview">Overview</h2>
<p>Load data from Wikidata, Wikipedia, and other sources as templates for processing. The Mash stage is the entry point to the data distillery workflow, preparing source data for validation, transformation, and submission.</p>
<p><strong>Current implementations:</strong></p>
<ul>
<li>Wikidata items (QID)</li>
<li>Wikidata properties (PID)</li>
<li>Wikidata EntitySchemas (EID)</li>
<li>Wikipedia templates</li>
</ul>
<p><strong>Future implementations:</strong> OSM, Wikimedia Commons, CSV files, JSON APIs, dataframes</p>
<h2 id="quick-start">Quick Start</h2>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikidataLoader</span><span class="p">,</span> <span class="n">WikipediaLoader</span>

<span class="c1"># Load Wikidata entities</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="p">()</span>

<span class="c1"># Load a single item</span>
<span class="n">item</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_item</span><span class="p">(</span><span class="s2">&quot;Q42&quot;</span><span class="p">)</span>

<span class="c1"># Load multiple items in batch</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_items</span><span class="p">([</span><span class="s2">&quot;Q42&quot;</span><span class="p">,</span> <span class="s2">&quot;Q5&quot;</span><span class="p">,</span> <span class="s2">&quot;Q30&quot;</span><span class="p">])</span>

<span class="c1"># Load a property</span>
<span class="n">prop</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_property</span><span class="p">(</span><span class="s2">&quot;P31&quot;</span><span class="p">)</span>

<span class="c1"># Load an EntitySchema</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_entity_schema</span><span class="p">(</span><span class="s2">&quot;E502&quot;</span><span class="p">)</span>

<span class="c1"># Load Wikipedia templates</span>
<span class="n">wp_loader</span> <span class="o">=</span> <span class="n">WikipediaLoader</span><span class="p">()</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">wp_loader</span><span class="o">.</span><span class="n">load_template</span><span class="p">(</span><span class="s2">&quot;Infobox settlement&quot;</span><span class="p">)</span>

<span class="c1"># Filter and transform</span>
<span class="n">item</span><span class="o">.</span><span class="n">filter_languages</span><span class="p">([</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="s2">&quot;es&quot;</span><span class="p">])</span>
<span class="n">summary</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="core-classes">Core Classes</h2>
<h3 id="wikidataloader">WikidataLoader</h3>


<div class="doc doc-object doc-class">



<a id="gkc.mash.WikidataLoader"></a>
    <div class="doc doc-contents first">


        <p>Load a Wikidata item as a template for bulk modification.</p>
<p>This is the Wikidata-specific implementation of a data loader.
Future loaders for CSV, JSON APIs, etc. should follow a similar pattern.</p>
<p>Plain meaning: Fetch and parse a Wikidata item into a usable template.</p>






              <details class="quote">
                <summary>Source code in <code>gkc/mash.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">WikidataLoader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a Wikidata item as a template for bulk modification.</span>

<span class="sd">    This is the Wikidata-specific implementation of a data loader.</span>
<span class="sd">    Future loaders for CSV, JSON APIs, etc. should follow a similar pattern.</span>

<span class="sd">    Plain meaning: Fetch and parse a Wikidata item into a usable template.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_agent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the loader.</span>

<span class="sd">        Args:</span>
<span class="sd">            user_agent: Custom user agent for Wikidata requests.</span>
<span class="sd">                       If not provided, a default GKC user agent is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">user_agent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">user_agent</span> <span class="o">=</span> <span class="s2">&quot;GKC/1.0 (https://github.com/skybristol/gkc; data integration)&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="n">user_agent</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikidataTemplate</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a Wikidata item and return it as a template.</span>

<span class="sd">        Args:</span>
<span class="sd">            qid: The Wikidata item ID (e.g., &#39;Q42&#39;).</span>

<span class="sd">        Returns:</span>
<span class="sd">            WikidataTemplate with the item&#39;s structure.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the item cannot be fetched or parsed.</span>

<span class="sd">        Plain meaning: Retrieve the item and return it ready for use.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; loader = WikidataLoader()</span>
<span class="sd">            &gt;&gt;&gt; template = loader.load_item(&quot;Q42&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(template.summary())</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">entity_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_entity_data</span><span class="p">(</span><span class="n">qid</span><span class="p">)</span>

        <span class="c1"># Convert to MashTemplate</span>
        <span class="n">template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_template</span><span class="p">(</span><span class="n">qid</span><span class="p">,</span> <span class="n">entity_data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">template</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikidataTemplate</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a Wikidata item and return it as a template.</span>

<span class="sd">        .. deprecated:: 1.0</span>
<span class="sd">            Use :meth:`load_item` instead. This method is maintained for</span>
<span class="sd">            backwards compatibility and will be removed in a future version.</span>

<span class="sd">        Args:</span>
<span class="sd">            qid: The Wikidata item ID (e.g., &#39;Q42&#39;).</span>

<span class="sd">        Returns:</span>
<span class="sd">            WikidataTemplate with the item&#39;s structure.</span>

<span class="sd">        Plain meaning: Retrieve the item and return it ready for use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_item</span><span class="p">(</span><span class="n">qid</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WikidataTemplate</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load multiple Wikidata items in batch and return them as templates.</span>

<span class="sd">        Uses the wbgetentities API to efficiently fetch multiple items in batches</span>
<span class="sd">        of 50. Handles partial failures gracefully.</span>

<span class="sd">        Args:</span>
<span class="sd">            qids: List of Wikidata item IDs (e.g., [&#39;Q42&#39;, &#39;Q5&#39;]).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict mapping QIDs to WikidataTemplates. Only successfully loaded</span>
<span class="sd">            items are included in the result.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the API request fails completely.</span>

<span class="sd">        Plain meaning: Load multiple items efficiently in batch.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; loader = WikidataLoader()</span>
<span class="sd">            &gt;&gt;&gt; templates = loader.load_items([&quot;Q42&quot;, &quot;Q5&quot;, &quot;Q30&quot;])</span>
<span class="sd">            &gt;&gt;&gt; print(len(templates))</span>
<span class="sd">            3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">qids</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>

        <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WikidataTemplate</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Process in batches of 50 (wbgetentities limit)</span>
        <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">qids</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="n">qids</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">]</span>
            <span class="n">batch_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_entities_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

            <span class="c1"># Build templates for each successfully fetched entity</span>
            <span class="k">for</span> <span class="n">qid</span><span class="p">,</span> <span class="n">entity_data</span> <span class="ow">in</span> <span class="n">batch_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_template</span><span class="p">(</span><span class="n">qid</span><span class="p">,</span> <span class="n">entity_data</span><span class="p">)</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">qid</span><span class="p">]</span> <span class="o">=</span> <span class="n">template</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="c1"># Skip items that fail to parse</span>
                    <span class="k">continue</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikidataPropertyTemplate</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a Wikidata property and return it as a template.</span>

<span class="sd">        Args:</span>
<span class="sd">            pid: The Wikidata property ID (e.g., &#39;P31&#39;).</span>

<span class="sd">        Returns:</span>
<span class="sd">            WikidataPropertyTemplate with the property&#39;s metadata.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the property cannot be fetched or parsed.</span>

<span class="sd">        Plain meaning: Retrieve a property definition and return it ready for use.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; loader = WikidataLoader()</span>
<span class="sd">            &gt;&gt;&gt; prop = loader.load_property(&quot;P31&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(prop.summary())</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">entity_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_entity_data</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_property_template</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">entity_data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_entity_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikidataEntitySchemaTemplate</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a Wikidata EntitySchema and return it as a template.</span>

<span class="sd">        Args:</span>
<span class="sd">            eid: The Wikidata EntitySchema ID (e.g., &#39;E502&#39;).</span>

<span class="sd">        Returns:</span>
<span class="sd">            WikidataEntitySchemaTemplate with the schema content.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the EntitySchema cannot be fetched or parsed.</span>

<span class="sd">        Plain meaning: Retrieve an EntitySchema and return it ready for use.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; loader = WikidataLoader()</span>
<span class="sd">            &gt;&gt;&gt; schema = loader.load_entity_schema(&quot;E502&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(schema.summary())</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gkc.cooperage</span><span class="w"> </span><span class="kn">import</span> <span class="n">fetch_entity_schema_json</span>

        <span class="n">entity_data</span> <span class="o">=</span> <span class="n">fetch_entity_schema_json</span><span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">user_agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_entity_schema_template</span><span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">entity_data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_fetch_entities_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch multiple entities using wbgetentities API.</span>

<span class="sd">        Args:</span>
<span class="sd">            entity_ids: List of entity IDs (max 50).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict mapping entity IDs to their entity data.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the API request fails.</span>

<span class="sd">        Plain meaning: Fetch a batch of entities from Wikidata.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.wikidata.org/w/api.php&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;wbgetentities&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">entity_ids</span><span class="p">),</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="p">:</span>
            <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

            <span class="c1"># Extract entities from response</span>
            <span class="n">entities</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entities&quot;</span><span class="p">,</span> <span class="p">{})</span>

            <span class="c1"># Filter out entities with &quot;missing&quot; key (not found)</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="n">eid</span><span class="p">:</span> <span class="n">entity_data</span>
                <span class="k">for</span> <span class="n">eid</span><span class="p">,</span> <span class="n">entity_data</span> <span class="ow">in</span> <span class="n">entities</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="s2">&quot;missing&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">entity_data</span>
            <span class="p">}</span>

        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to fetch entities batch: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_entity_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load raw Wikidata entity data.</span>

<span class="sd">        Plain meaning: Return the entity JSON as provided by Wikidata.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Fetch the item via Special:EntityData endpoint which returns JSON</span>
        <span class="c1"># This is equivalent to wbgetentities but simpler for single-item fetches</span>
        <span class="n">json_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_entity_json</span><span class="p">(</span><span class="n">qid</span><span class="p">)</span>

        <span class="c1"># Parse the JSON response from Wikidata</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_wikidata_json</span><span class="p">(</span><span class="n">json_text</span><span class="p">,</span> <span class="n">qid</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_fetch_entity_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fetch a single Wikidata entity as JSON.</span>

<span class="sd">        Args:</span>
<span class="sd">            qid: The Wikidata item ID (e.g., &#39;Q42&#39;).</span>

<span class="sd">        Returns:</span>
<span class="sd">            JSON string with entity data.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the fetch fails or entity doesn&#39;t exist.</span>

<span class="sd">        Plain meaning: Download the item from Wikidata as JSON.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.wikidata.org/wiki/Special:EntityData/</span><span class="si">{</span><span class="n">qid</span><span class="si">}</span><span class="s2">.json&quot;</span>

        <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="p">:</span>
            <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

            <span class="c1"># Handle 404 or 400 errors which indicate item doesn&#39;t exist</span>
            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;no-such-entity: </span><span class="si">{</span><span class="n">qid</span><span class="si">}</span><span class="s2"> not found on Wikidata&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;no-such-entity: </span><span class="si">{</span><span class="n">qid</span><span class="si">}</span><span class="s2"> is invalid&quot;</span><span class="p">)</span>

            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load item </span><span class="si">{</span><span class="n">qid</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_wikidata_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">qid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse Wikidata JSON response from Special:EntityData endpoint.</span>

<span class="sd">        Args:</span>
<span class="sd">            json_text: Raw JSON response text.</span>
<span class="sd">            qid: The QID being parsed (used for error messages).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary with entity data.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If JSON parsing fails or format is unexpected.</span>

<span class="sd">        Plain meaning: Extract entity data from the API response.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_text</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to parse JSON response for </span><span class="si">{</span><span class="n">qid</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected JSON object for </span><span class="si">{</span><span class="n">qid</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Special:EntityData wraps data in an &quot;entities&quot; key</span>
        <span class="n">entities</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entities&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">entity_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">entities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">qid</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1"># Check for API error</span>
        <span class="k">if</span> <span class="s2">&quot;error&quot;</span> <span class="ow">in</span> <span class="n">entity_data</span><span class="p">:</span>
            <span class="n">error_code</span> <span class="o">=</span> <span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown&quot;</span><span class="p">)</span>
            <span class="n">error_info</span> <span class="o">=</span> <span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;No error details&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Wikidata API error for </span><span class="si">{</span><span class="n">qid</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">error_code</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">error_info</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">entity_data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Entity </span><span class="si">{</span><span class="n">qid</span><span class="si">}</span><span class="s2"> not found in response&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">entity_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">entity_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikidataTemplate</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert entity data to a WikidataTemplate.</span>

<span class="sd">        Plain meaning: Transform API data into our simplified format.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Extract labels, descriptions, aliases</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">descriptions</span> <span class="o">=</span> <span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;descriptions&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">aliases</span> <span class="o">=</span> <span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aliases&quot;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1"># Simplify to language -&gt; value mappings</span>
        <span class="n">labels_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">descriptions_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">aliases_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="p">[</span><span class="n">alias</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">alias_list</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">alias_list</span> <span class="ow">in</span> <span class="n">aliases</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alias_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># Extract claims</span>
        <span class="n">claims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_claims</span><span class="p">(</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;claims&quot;</span><span class="p">,</span> <span class="p">{}))</span>

        <span class="k">return</span> <span class="n">WikidataTemplate</span><span class="p">(</span>
            <span class="n">qid</span><span class="o">=</span><span class="n">qid</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">labels_dict</span><span class="p">,</span>
            <span class="n">descriptions</span><span class="o">=</span><span class="n">descriptions_dict</span><span class="p">,</span>
            <span class="n">aliases</span><span class="o">=</span><span class="n">aliases_dict</span><span class="p">,</span>
            <span class="n">claims</span><span class="o">=</span><span class="n">claims</span><span class="p">,</span>
            <span class="n">entity_data</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">entity_data</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_claims</span><span class="p">(</span><span class="n">claims_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ClaimSummary</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract claims from entity data.</span>

<span class="sd">        Plain meaning: Parse statement data into simplified claim objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">claims</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ClaimSummary</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">prop_id</span><span class="p">,</span> <span class="n">statements</span> <span class="ow">in</span> <span class="n">claims_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">statements</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="k">for</span> <span class="n">statement</span> <span class="ow">in</span> <span class="n">statements</span><span class="p">:</span>
                <span class="n">claim</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="o">.</span><span class="n">_statement_to_claim</span><span class="p">(</span><span class="n">prop_id</span><span class="p">,</span> <span class="n">statement</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">claim</span><span class="p">:</span>
                    <span class="n">claims</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">claim</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">claims</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build_property_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">pid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">entity_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikidataPropertyTemplate</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert entity data to a WikidataPropertyTemplate.</span>

<span class="sd">        Plain meaning: Transform API data into our simplified property format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Extract labels, descriptions, aliases</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">descriptions</span> <span class="o">=</span> <span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;descriptions&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">aliases</span> <span class="o">=</span> <span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aliases&quot;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1"># Simplify to language -&gt; value mappings</span>
        <span class="n">labels_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">descriptions_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">aliases_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="p">[</span><span class="n">alias</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">alias_list</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">alias_list</span> <span class="ow">in</span> <span class="n">aliases</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alias_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># Extract property-specific metadata</span>
        <span class="n">datatype</span> <span class="o">=</span> <span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;datatype&quot;</span><span class="p">)</span>

        <span class="c1"># Formatter URL is in claims P1630</span>
        <span class="n">formatter_url</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">claims</span> <span class="o">=</span> <span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;claims&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">p1630_statements</span> <span class="o">=</span> <span class="n">claims</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;P1630&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">p1630_statements</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p1630_statements</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">first_statement</span> <span class="o">=</span> <span class="n">p1630_statements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">mainsnak</span> <span class="o">=</span> <span class="n">first_statement</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mainsnak&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">datavalue</span> <span class="o">=</span> <span class="n">mainsnak</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;datavalue&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">if</span> <span class="n">datavalue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;string&quot;</span><span class="p">:</span>
                <span class="n">formatter_url</span> <span class="o">=</span> <span class="n">datavalue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">WikidataPropertyTemplate</span><span class="p">(</span>
            <span class="n">pid</span><span class="o">=</span><span class="n">pid</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">labels_dict</span><span class="p">,</span>
            <span class="n">descriptions</span><span class="o">=</span><span class="n">descriptions_dict</span><span class="p">,</span>
            <span class="n">aliases</span><span class="o">=</span><span class="n">aliases_dict</span><span class="p">,</span>
            <span class="n">datatype</span><span class="o">=</span><span class="n">datatype</span><span class="p">,</span>
            <span class="n">formatter_url</span><span class="o">=</span><span class="n">formatter_url</span><span class="p">,</span>
            <span class="n">entity_data</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">entity_data</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build_entity_schema_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">eid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">entity_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikidataEntitySchemaTemplate</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert entity data to a WikidataEntitySchemaTemplate.</span>

<span class="sd">        Plain meaning: Transform API data into our simplified EntitySchema format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Extract labels and descriptions</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">descriptions</span> <span class="o">=</span> <span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;descriptions&quot;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1"># Simplify to language -&gt; value mappings</span>
        <span class="n">labels_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">descriptions_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># Extract schema text</span>
        <span class="n">schema_text</span> <span class="o">=</span> <span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;schemaText&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">WikidataEntitySchemaTemplate</span><span class="p">(</span>
            <span class="n">eid</span><span class="o">=</span><span class="n">eid</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">labels_dict</span><span class="p">,</span>
            <span class="n">descriptions</span><span class="o">=</span><span class="n">descriptions_dict</span><span class="p">,</span>
            <span class="n">schema_text</span><span class="o">=</span><span class="n">schema_text</span><span class="p">,</span>
            <span class="n">entity_data</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">entity_data</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_statement_to_claim</span><span class="p">(</span>
        <span class="n">prop_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">statement</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ClaimSummary</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a single statement to a ClaimSummary.</span>

<span class="sd">        Plain meaning: Simplify a statement object for display.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Extract main value</span>
        <span class="n">mainsnak</span> <span class="o">=</span> <span class="n">statement</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mainsnak&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">value</span><span class="p">,</span> <span class="n">value_metadata</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="o">.</span><span class="n">_snak_to_value</span><span class="p">(</span><span class="n">mainsnak</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Extract qualifiers with their values</span>
        <span class="n">qualifiers</span> <span class="o">=</span> <span class="n">statement</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;qualifiers&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">qualifiers_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">prop</span><span class="p">,</span> <span class="n">snaks</span> <span class="ow">in</span> <span class="n">qualifiers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">snaks</span><span class="p">:</span>
                <span class="c1"># Extract value from the first snak of each qualifier property</span>
                <span class="n">snak</span> <span class="o">=</span> <span class="n">snaks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">qual_value</span><span class="p">,</span> <span class="n">qual_metadata</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="o">.</span><span class="n">_snak_to_value</span><span class="p">(</span><span class="n">snak</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">qual_value</span><span class="p">:</span>
                    <span class="n">qualifier_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;property&quot;</span><span class="p">:</span> <span class="n">prop</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">qual_value</span><span class="p">}</span>
                    <span class="k">if</span> <span class="n">qual_metadata</span><span class="p">:</span>
                        <span class="n">qualifier_dict</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qual_metadata</span>
                    <span class="n">qualifiers_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qualifier_dict</span><span class="p">)</span>

        <span class="c1"># Extract references</span>
        <span class="n">references</span> <span class="o">=</span> <span class="n">statement</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;references&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">references_list</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;snaks&quot;</span><span class="p">,</span> <span class="p">{}))}</span> <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">references</span><span class="p">]</span>

        <span class="n">rank</span> <span class="o">=</span> <span class="n">statement</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rank&quot;</span><span class="p">,</span> <span class="s2">&quot;normal&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ClaimSummary</span><span class="p">(</span>
            <span class="n">property_id</span><span class="o">=</span><span class="n">prop_id</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
            <span class="n">qualifiers</span><span class="o">=</span><span class="n">qualifiers_list</span><span class="p">,</span>
            <span class="n">references</span><span class="o">=</span><span class="n">references_list</span><span class="p">,</span>
            <span class="n">rank</span><span class="o">=</span><span class="n">rank</span><span class="p">,</span>
            <span class="n">value_metadata</span><span class="o">=</span><span class="n">value_metadata</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_snak_to_value</span><span class="p">(</span>
        <span class="n">snak</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract a human-readable value from a snak with metadata.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple of (value_string, metadata_dict) where metadata contains</span>
<span class="sd">            things like precision for dates, units for quantities, etc.</span>

<span class="sd">        Plain meaning: Get a simple string representation of the value plus metadata.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">snaktype</span> <span class="o">=</span> <span class="n">snak</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;snaktype&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">snaktype</span> <span class="o">==</span> <span class="s2">&quot;novalue&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;[no value]&quot;</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">snaktype</span> <span class="o">==</span> <span class="s2">&quot;somevalue&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;[unknown value]&quot;</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">datavalue</span> <span class="o">=</span> <span class="n">snak</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;datavalue&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">datavalue</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">dv_type</span> <span class="o">=</span> <span class="n">datavalue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">dv_value</span> <span class="o">=</span> <span class="n">datavalue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dv_type</span> <span class="o">==</span> <span class="s2">&quot;wikibase-entityid&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dv_value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">dv_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;[entity]&quot;</span><span class="p">),</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">dv_value</span><span class="p">),</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">dv_type</span> <span class="o">==</span> <span class="s2">&quot;quantity&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dv_value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">amount</span> <span class="o">=</span> <span class="n">dv_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;amount&quot;</span><span class="p">,</span> <span class="s2">&quot;[quantity]&quot;</span><span class="p">)</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="n">dv_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unit&quot;</span><span class="p">)</span>
                <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="n">unit</span><span class="p">}</span> <span class="k">if</span> <span class="n">unit</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="n">amount</span><span class="p">,</span> <span class="n">metadata</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">dv_value</span><span class="p">),</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">dv_type</span> <span class="o">==</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dv_value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">time_str</span> <span class="o">=</span> <span class="n">dv_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;[time]&quot;</span><span class="p">)</span>
                <span class="n">precision</span> <span class="o">=</span> <span class="n">dv_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;precision&quot;</span><span class="p">)</span>
                <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="n">precision</span><span class="p">}</span> <span class="k">if</span> <span class="n">precision</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="n">time_str</span><span class="p">,</span> <span class="n">metadata</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">dv_value</span><span class="p">),</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">dv_type</span> <span class="o">==</span> <span class="s2">&quot;monolingualtext&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dv_value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">dv_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;[text]&quot;</span><span class="p">),</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">dv_value</span><span class="p">),</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">dv_type</span> <span class="o">==</span> <span class="s2">&quot;string&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">dv_value</span><span class="p">),</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">dv_type</span> <span class="o">==</span> <span class="s2">&quot;globecoordinate&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dv_value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">lat</span> <span class="o">=</span> <span class="n">dv_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;?&quot;</span><span class="p">)</span>
                <span class="n">lon</span> <span class="o">=</span> <span class="n">dv_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;?&quot;</span><span class="p">)</span>
                <span class="n">precision_val</span> <span class="o">=</span> <span class="n">dv_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;precision&quot;</span><span class="p">)</span>
                <span class="n">metadata</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="p">{</span><span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="n">precision_val</span><span class="p">}</span> <span class="k">if</span> <span class="n">precision_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">lat</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">lon</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">metadata</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">dv_value</span><span class="p">),</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dv_value</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span> <span class="k">if</span> <span class="n">dv_value</span> <span class="k">else</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataLoader.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">user_agent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initialize the loader.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_agent</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom user agent for Wikidata requests.
       If not provided, a default GKC user agent is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_agent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the loader.</span>

<span class="sd">    Args:</span>
<span class="sd">        user_agent: Custom user agent for Wikidata requests.</span>
<span class="sd">                   If not provided, a default GKC user agent is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">user_agent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">user_agent</span> <span class="o">=</span> <span class="s2">&quot;GKC/1.0 (https://github.com/skybristol/gkc; data integration)&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="n">user_agent</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataLoader.load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">qid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Load a Wikidata item and return it as a template.</p>
<p>.. deprecated:: 1.0
    Use :meth:<code>load_item</code> instead. This method is maintained for
    backwards compatibility and will be removed in a future version.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qid</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Wikidata item ID (e.g., 'Q42').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="gkc.mash.WikidataTemplate" href="#gkc.mash.WikidataTemplate">WikidataTemplate</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>WikidataTemplate with the item's structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Retrieve the item and return it ready for use.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikidataTemplate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a Wikidata item and return it as a template.</span>

<span class="sd">    .. deprecated:: 1.0</span>
<span class="sd">        Use :meth:`load_item` instead. This method is maintained for</span>
<span class="sd">        backwards compatibility and will be removed in a future version.</span>

<span class="sd">    Args:</span>
<span class="sd">        qid: The Wikidata item ID (e.g., &#39;Q42&#39;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        WikidataTemplate with the item&#39;s structure.</span>

<span class="sd">    Plain meaning: Retrieve the item and return it ready for use.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_item</span><span class="p">(</span><span class="n">qid</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataLoader.load_entity_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_entity_data</span><span class="p">(</span><span class="n">qid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Load raw Wikidata entity data.</p>
<p>Plain meaning: Return the entity JSON as provided by Wikidata.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_entity_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load raw Wikidata entity data.</span>

<span class="sd">    Plain meaning: Return the entity JSON as provided by Wikidata.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Fetch the item via Special:EntityData endpoint which returns JSON</span>
    <span class="c1"># This is equivalent to wbgetentities but simpler for single-item fetches</span>
    <span class="n">json_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_entity_json</span><span class="p">(</span><span class="n">qid</span><span class="p">)</span>

    <span class="c1"># Parse the JSON response from Wikidata</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_wikidata_json</span><span class="p">(</span><span class="n">json_text</span><span class="p">,</span> <span class="n">qid</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataLoader.load_entity_schema" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_entity_schema</span><span class="p">(</span><span class="n">eid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Load a Wikidata EntitySchema and return it as a template.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>eid</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Wikidata EntitySchema ID (e.g., 'E502').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="gkc.mash.WikidataEntitySchemaTemplate" href="#gkc.mash.WikidataEntitySchemaTemplate">WikidataEntitySchemaTemplate</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>WikidataEntitySchemaTemplate with the schema content.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the EntitySchema cannot be fetched or parsed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Retrieve an EntitySchema and return it ready for use.</p>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>loader = WikidataLoader()
schema = loader.load_entity_schema("E502")
print(schema.summary())</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_entity_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikidataEntitySchemaTemplate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a Wikidata EntitySchema and return it as a template.</span>

<span class="sd">    Args:</span>
<span class="sd">        eid: The Wikidata EntitySchema ID (e.g., &#39;E502&#39;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        WikidataEntitySchemaTemplate with the schema content.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the EntitySchema cannot be fetched or parsed.</span>

<span class="sd">    Plain meaning: Retrieve an EntitySchema and return it ready for use.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; loader = WikidataLoader()</span>
<span class="sd">        &gt;&gt;&gt; schema = loader.load_entity_schema(&quot;E502&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(schema.summary())</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">gkc.cooperage</span><span class="w"> </span><span class="kn">import</span> <span class="n">fetch_entity_schema_json</span>

    <span class="n">entity_data</span> <span class="o">=</span> <span class="n">fetch_entity_schema_json</span><span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">user_agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_entity_schema_template</span><span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">entity_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataLoader.load_item" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_item</span><span class="p">(</span><span class="n">qid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Load a Wikidata item and return it as a template.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qid</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Wikidata item ID (e.g., 'Q42').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="gkc.mash.WikidataTemplate" href="#gkc.mash.WikidataTemplate">WikidataTemplate</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>WikidataTemplate with the item's structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the item cannot be fetched or parsed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Retrieve the item and return it ready for use.</p>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>loader = WikidataLoader()
template = loader.load_item("Q42")
print(template.summary())</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikidataTemplate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a Wikidata item and return it as a template.</span>

<span class="sd">    Args:</span>
<span class="sd">        qid: The Wikidata item ID (e.g., &#39;Q42&#39;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        WikidataTemplate with the item&#39;s structure.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the item cannot be fetched or parsed.</span>

<span class="sd">    Plain meaning: Retrieve the item and return it ready for use.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; loader = WikidataLoader()</span>
<span class="sd">        &gt;&gt;&gt; template = loader.load_item(&quot;Q42&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(template.summary())</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">entity_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_entity_data</span><span class="p">(</span><span class="n">qid</span><span class="p">)</span>

    <span class="c1"># Convert to MashTemplate</span>
    <span class="n">template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_template</span><span class="p">(</span><span class="n">qid</span><span class="p">,</span> <span class="n">entity_data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">template</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataLoader.load_items" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_items</span><span class="p">(</span><span class="n">qids</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Load multiple Wikidata items in batch and return them as templates.</p>
<p>Uses the wbgetentities API to efficiently fetch multiple items in batches
of 50. Handles partial failures gracefully.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>qids</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Wikidata item IDs (e.g., ['Q42', 'Q5']).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="gkc.mash.WikidataTemplate" href="#gkc.mash.WikidataTemplate">WikidataTemplate</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict mapping QIDs to WikidataTemplates. Only successfully loaded</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="gkc.mash.WikidataTemplate" href="#gkc.mash.WikidataTemplate">WikidataTemplate</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>items are included in the result.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the API request fails completely.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Load multiple items efficiently in batch.</p>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>loader = WikidataLoader()
templates = loader.load_items(["Q42", "Q5", "Q30"])
print(len(templates))
3</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WikidataTemplate</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load multiple Wikidata items in batch and return them as templates.</span>

<span class="sd">    Uses the wbgetentities API to efficiently fetch multiple items in batches</span>
<span class="sd">    of 50. Handles partial failures gracefully.</span>

<span class="sd">    Args:</span>
<span class="sd">        qids: List of Wikidata item IDs (e.g., [&#39;Q42&#39;, &#39;Q5&#39;]).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict mapping QIDs to WikidataTemplates. Only successfully loaded</span>
<span class="sd">        items are included in the result.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the API request fails completely.</span>

<span class="sd">    Plain meaning: Load multiple items efficiently in batch.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; loader = WikidataLoader()</span>
<span class="sd">        &gt;&gt;&gt; templates = loader.load_items([&quot;Q42&quot;, &quot;Q5&quot;, &quot;Q30&quot;])</span>
<span class="sd">        &gt;&gt;&gt; print(len(templates))</span>
<span class="sd">        3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">qids</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WikidataTemplate</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Process in batches of 50 (wbgetentities limit)</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">qids</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>
        <span class="n">batch</span> <span class="o">=</span> <span class="n">qids</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">]</span>
        <span class="n">batch_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_entities_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

        <span class="c1"># Build templates for each successfully fetched entity</span>
        <span class="k">for</span> <span class="n">qid</span><span class="p">,</span> <span class="n">entity_data</span> <span class="ow">in</span> <span class="n">batch_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_template</span><span class="p">(</span><span class="n">qid</span><span class="p">,</span> <span class="n">entity_data</span><span class="p">)</span>
                <span class="n">result</span><span class="p">[</span><span class="n">qid</span><span class="p">]</span> <span class="o">=</span> <span class="n">template</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># Skip items that fail to parse</span>
                <span class="k">continue</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataLoader.load_property" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_property</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Load a Wikidata property and return it as a template.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pid</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Wikidata property ID (e.g., 'P31').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="gkc.mash.WikidataPropertyTemplate" href="#gkc.mash.WikidataPropertyTemplate">WikidataPropertyTemplate</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>WikidataPropertyTemplate with the property's metadata.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the property cannot be fetched or parsed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Retrieve a property definition and return it ready for use.</p>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>loader = WikidataLoader()
prop = loader.load_property("P31")
print(prop.summary())</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pid</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikidataPropertyTemplate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a Wikidata property and return it as a template.</span>

<span class="sd">    Args:</span>
<span class="sd">        pid: The Wikidata property ID (e.g., &#39;P31&#39;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        WikidataPropertyTemplate with the property&#39;s metadata.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the property cannot be fetched or parsed.</span>

<span class="sd">    Plain meaning: Retrieve a property definition and return it ready for use.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; loader = WikidataLoader()</span>
<span class="sd">        &gt;&gt;&gt; prop = loader.load_property(&quot;P31&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(prop.summary())</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">entity_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_entity_data</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_property_template</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">entity_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="wikidatatemplate">WikidataTemplate</h3>


<div class="doc doc-object doc-class">



<a id="gkc.mash.WikidataTemplate"></a>
    <div class="doc doc-contents first">


        <p>An extracted Wikidata item ready for filtering and export.</p>
<p>This is the Wikidata-specific implementation of the DataTemplate protocol.</p>
<p>Plain meaning: A loaded Wikidata item template ready for modification.</p>






              <details class="quote">
                <summary>Source code in <code>gkc/mash.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">WikidataTemplate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An extracted Wikidata item ready for filtering and export.</span>

<span class="sd">    This is the Wikidata-specific implementation of the DataTemplate protocol.</span>

<span class="sd">    Plain meaning: A loaded Wikidata item template ready for modification.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">qid</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="n">descriptions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="n">aliases</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="n">claims</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ClaimSummary</span><span class="p">]</span>
    <span class="n">entity_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_properties</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">include_properties</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exclude_properties</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter properties from the template in-place.</span>

<span class="sd">        Plain meaning: Keep only specified properties, then drop excluded ones.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">include_properties</span><span class="p">:</span>
            <span class="n">include_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">include_properties</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">claims</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">claim</span> <span class="k">for</span> <span class="n">claim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">claims</span> <span class="k">if</span> <span class="n">claim</span><span class="o">.</span><span class="n">property_id</span> <span class="ow">in</span> <span class="n">include_set</span>
            <span class="p">]</span>
            <span class="n">claims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;claims&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;claims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">prop_id</span><span class="p">:</span> <span class="n">statements</span>
                    <span class="k">for</span> <span class="n">prop_id</span><span class="p">,</span> <span class="n">statements</span> <span class="ow">in</span> <span class="n">claims</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">prop_id</span> <span class="ow">in</span> <span class="n">include_set</span>
                <span class="p">}</span>

        <span class="k">if</span> <span class="n">exclude_properties</span><span class="p">:</span>
            <span class="n">exclude_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exclude_properties</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">claims</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">claim</span> <span class="k">for</span> <span class="n">claim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">claims</span> <span class="k">if</span> <span class="n">claim</span><span class="o">.</span><span class="n">property_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_set</span>
            <span class="p">]</span>
            <span class="n">claims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;claims&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;claims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">prop_id</span><span class="p">:</span> <span class="n">statements</span>
                    <span class="k">for</span> <span class="n">prop_id</span><span class="p">,</span> <span class="n">statements</span> <span class="ow">in</span> <span class="n">claims</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">prop_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_set</span>
                <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_qualifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove all qualifiers from claims in-place.</span>

<span class="sd">        Plain meaning: Strip qualifier detail from claims.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">claim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">claims</span><span class="p">:</span>
            <span class="n">claim</span><span class="o">.</span><span class="n">qualifiers</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">claims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;claims&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">statements</span> <span class="ow">in</span> <span class="n">claims</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">statements</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">for</span> <span class="n">statement</span> <span class="ow">in</span> <span class="n">statements</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="n">statement</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;qualifiers&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                        <span class="n">statement</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;qualifiers-order&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_references</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove all references from claims in-place.</span>

<span class="sd">        Plain meaning: Strip reference detail from claims.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">claim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">claims</span><span class="p">:</span>
            <span class="n">claim</span><span class="o">.</span><span class="n">references</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">claims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;claims&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">statements</span> <span class="ow">in</span> <span class="n">claims</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">statements</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">for</span> <span class="n">statement</span> <span class="ow">in</span> <span class="n">statements</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="n">statement</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;references&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_languages</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">languages</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter labels, descriptions, and aliases to specified languages.</span>

<span class="sd">        Args:</span>
<span class="sd">            languages: Either:</span>
<span class="sd">                - A single language code (e.g., &quot;en&quot;)</span>
<span class="sd">                - A list of language codes (e.g., [&quot;en&quot;, &quot;es&quot;, &quot;fr&quot;])</span>
<span class="sd">                - The string &quot;all&quot; to keep all languages</span>
<span class="sd">                - None to use the package-level language configuration</span>

<span class="sd">        Plain meaning: Keep only the specified language versions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">gkc</span>

        <span class="k">if</span> <span class="n">languages</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">languages</span> <span class="o">=</span> <span class="n">gkc</span><span class="o">.</span><span class="n">get_languages</span><span class="p">()</span>

        <span class="c1"># If &quot;all&quot;, don&#39;t filter anything</span>
        <span class="k">if</span> <span class="n">languages</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Convert single string to list for uniform handling</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">languages</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">languages</span> <span class="o">=</span> <span class="p">[</span><span class="n">languages</span><span class="p">]</span>

        <span class="c1"># Filter each field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">}</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
            <span class="p">}</span>

        <span class="n">descriptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;descriptions&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">descriptions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;descriptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
            <span class="p">}</span>

        <span class="n">aliases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aliases&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aliases</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">aliases</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
            <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a summary of the template for display.</span>

<span class="sd">        Plain meaning: Get a quick overview without full details.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;qid&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">qid</span><span class="p">,</span>
            <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
            <span class="s2">&quot;descriptions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="p">,</span>
            <span class="s2">&quot;total_statements&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">claims</span><span class="p">),</span>
            <span class="s2">&quot;aliases&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Serialize to a dictionary.</span>

<span class="sd">        Plain meaning: Convert to a form suitable for JSON export.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_simple_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Serialize to a simplified dictionary.</span>

<span class="sd">        Plain meaning: Convert to a compact summary structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;qid&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">qid</span><span class="p">,</span>
            <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
            <span class="s2">&quot;descriptions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="p">,</span>
            <span class="s2">&quot;aliases&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="p">,</span>
            <span class="s2">&quot;claims&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;property_id&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">property_id</span><span class="p">,</span>
                    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                    <span class="s2">&quot;qualifiers&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">,</span>
                    <span class="s2">&quot;references&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">references</span><span class="p">,</span>
                    <span class="s2">&quot;rank&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">rank</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">claims</span>
            <span class="p">],</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_shell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Strip identifiers and metadata to create a shell for new item creation.</span>

<span class="sd">        Returns entity data with all system IDs, metadata, and hashes removed,</span>
<span class="sd">        suitable for use as a template for creating new items.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict with identifiers stripped, ready for new item creation.</span>

<span class="sd">        Plain meaning: Prepare this template as a clean shell for a new item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">strip_entity_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_qsv1</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">for_new_item</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">entity_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to QuickStatements V1 format.</span>

<span class="sd">        Args:</span>
<span class="sd">            for_new_item: If True, use CREATE/LAST syntax for new items.</span>
<span class="sd">                         If False, use the item&#39;s QID for updates.</span>
<span class="sd">            entity_labels: Optional dict mapping entity IDs to labels for comments.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuickStatements V1 formatted string.</span>

<span class="sd">        Plain meaning: Export as QuickStatements commands for bulk operations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash_formatters</span><span class="w"> </span><span class="kn">import</span> <span class="n">QSV1Formatter</span>

        <span class="n">formatter</span> <span class="o">=</span> <span class="n">QSV1Formatter</span><span class="p">(</span><span class="n">entity_labels</span><span class="o">=</span><span class="n">entity_labels</span> <span class="ow">or</span> <span class="p">{})</span>
        <span class="k">return</span> <span class="n">formatter</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">for_new_item</span><span class="o">=</span><span class="n">for_new_item</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_gkc_entity_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to GKC Entity Profile format.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict representing the GKC Entity Profile.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: This transformation is not yet implemented for items.</span>

<span class="sd">        Plain meaning: Transform into a GKC Entity Profile (not yet implemented).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;Item to GKC Entity Profile transformation is not yet implemented. &quot;</span>
            <span class="s2">&quot;This will be added in a future version.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataTemplate.filter_languages" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_languages</span><span class="p">(</span><span class="n">languages</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Filter labels, descriptions, and aliases to specified languages.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>languages</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="list">list</span>[<span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either:
- A single language code (e.g., "en")
- A list of language codes (e.g., ["en", "es", "fr"])
- The string "all" to keep all languages
- None to use the package-level language configuration</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Keep only the specified language versions.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_languages</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">languages</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter labels, descriptions, and aliases to specified languages.</span>

<span class="sd">    Args:</span>
<span class="sd">        languages: Either:</span>
<span class="sd">            - A single language code (e.g., &quot;en&quot;)</span>
<span class="sd">            - A list of language codes (e.g., [&quot;en&quot;, &quot;es&quot;, &quot;fr&quot;])</span>
<span class="sd">            - The string &quot;all&quot; to keep all languages</span>
<span class="sd">            - None to use the package-level language configuration</span>

<span class="sd">    Plain meaning: Keep only the specified language versions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">gkc</span>

    <span class="k">if</span> <span class="n">languages</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">languages</span> <span class="o">=</span> <span class="n">gkc</span><span class="o">.</span><span class="n">get_languages</span><span class="p">()</span>

    <span class="c1"># If &quot;all&quot;, don&#39;t filter anything</span>
    <span class="k">if</span> <span class="n">languages</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="c1"># Convert single string to list for uniform handling</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">languages</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">languages</span> <span class="o">=</span> <span class="p">[</span><span class="n">languages</span><span class="p">]</span>

    <span class="c1"># Filter each field</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">}</span>

    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
        <span class="p">}</span>

    <span class="n">descriptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;descriptions&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">descriptions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;descriptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
        <span class="p">}</span>

    <span class="n">aliases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aliases&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aliases</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">aliases</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataTemplate.filter_properties" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_properties</span><span class="p">(</span><span class="n">include_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exclude_properties</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Filter properties from the template in-place.</p>
<p>Plain meaning: Keep only specified properties, then drop excluded ones.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_properties</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">include_properties</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_properties</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter properties from the template in-place.</span>

<span class="sd">    Plain meaning: Keep only specified properties, then drop excluded ones.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">include_properties</span><span class="p">:</span>
        <span class="n">include_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">include_properties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">claims</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">claim</span> <span class="k">for</span> <span class="n">claim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">claims</span> <span class="k">if</span> <span class="n">claim</span><span class="o">.</span><span class="n">property_id</span> <span class="ow">in</span> <span class="n">include_set</span>
        <span class="p">]</span>
        <span class="n">claims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;claims&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;claims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">prop_id</span><span class="p">:</span> <span class="n">statements</span>
                <span class="k">for</span> <span class="n">prop_id</span><span class="p">,</span> <span class="n">statements</span> <span class="ow">in</span> <span class="n">claims</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">prop_id</span> <span class="ow">in</span> <span class="n">include_set</span>
            <span class="p">}</span>

    <span class="k">if</span> <span class="n">exclude_properties</span><span class="p">:</span>
        <span class="n">exclude_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exclude_properties</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">claims</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">claim</span> <span class="k">for</span> <span class="n">claim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">claims</span> <span class="k">if</span> <span class="n">claim</span><span class="o">.</span><span class="n">property_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_set</span>
        <span class="p">]</span>
        <span class="n">claims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;claims&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;claims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">prop_id</span><span class="p">:</span> <span class="n">statements</span>
                <span class="k">for</span> <span class="n">prop_id</span><span class="p">,</span> <span class="n">statements</span> <span class="ow">in</span> <span class="n">claims</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">prop_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_set</span>
            <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataTemplate.filter_qualifiers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_qualifiers</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Remove all qualifiers from claims in-place.</p>
<p>Plain meaning: Strip qualifier detail from claims.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_qualifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove all qualifiers from claims in-place.</span>

<span class="sd">    Plain meaning: Strip qualifier detail from claims.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">claim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">claims</span><span class="p">:</span>
        <span class="n">claim</span><span class="o">.</span><span class="n">qualifiers</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">claims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;claims&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">statements</span> <span class="ow">in</span> <span class="n">claims</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">statements</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">statement</span> <span class="ow">in</span> <span class="n">statements</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">statement</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;qualifiers&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="n">statement</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;qualifiers-order&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataTemplate.filter_references" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_references</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Remove all references from claims in-place.</p>
<p>Plain meaning: Strip reference detail from claims.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_references</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove all references from claims in-place.</span>

<span class="sd">    Plain meaning: Strip reference detail from claims.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">claim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">claims</span><span class="p">:</span>
        <span class="n">claim</span><span class="o">.</span><span class="n">references</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">claims</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;claims&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">statements</span> <span class="ow">in</span> <span class="n">claims</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">statements</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">statement</span> <span class="ow">in</span> <span class="n">statements</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">statement</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;references&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataTemplate.summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summary</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a summary of the template for display.</p>
<p>Plain meaning: Get a quick overview without full details.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a summary of the template for display.</span>

<span class="sd">    Plain meaning: Get a quick overview without full details.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;qid&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">qid</span><span class="p">,</span>
        <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
        <span class="s2">&quot;descriptions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="p">,</span>
        <span class="s2">&quot;total_statements&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">claims</span><span class="p">),</span>
        <span class="s2">&quot;aliases&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataTemplate.to_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dict</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Serialize to a dictionary.</p>
<p>Plain meaning: Convert to a form suitable for JSON export.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialize to a dictionary.</span>

<span class="sd">    Plain meaning: Convert to a form suitable for JSON export.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataTemplate.to_gkc_entity_profile" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_gkc_entity_profile</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Convert to GKC Entity Profile format.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict representing the GKC Entity Profile.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This transformation is not yet implemented for items.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Transform into a GKC Entity Profile (not yet implemented).</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_gkc_entity_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to GKC Entity Profile format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict representing the GKC Entity Profile.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: This transformation is not yet implemented for items.</span>

<span class="sd">    Plain meaning: Transform into a GKC Entity Profile (not yet implemented).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
        <span class="s2">&quot;Item to GKC Entity Profile transformation is not yet implemented. &quot;</span>
        <span class="s2">&quot;This will be added in a future version.&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataTemplate.to_qsv1" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_qsv1</span><span class="p">(</span><span class="n">for_new_item</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">entity_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Convert to QuickStatements V1 format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>for_new_item</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, use CREATE/LAST syntax for new items.
         If False, use the item's QID for updates.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>entity_labels</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dict mapping entity IDs to labels for comments.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>QuickStatements V1 formatted string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Export as QuickStatements commands for bulk operations.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_qsv1</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">for_new_item</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">entity_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to QuickStatements V1 format.</span>

<span class="sd">    Args:</span>
<span class="sd">        for_new_item: If True, use CREATE/LAST syntax for new items.</span>
<span class="sd">                     If False, use the item&#39;s QID for updates.</span>
<span class="sd">        entity_labels: Optional dict mapping entity IDs to labels for comments.</span>

<span class="sd">    Returns:</span>
<span class="sd">        QuickStatements V1 formatted string.</span>

<span class="sd">    Plain meaning: Export as QuickStatements commands for bulk operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash_formatters</span><span class="w"> </span><span class="kn">import</span> <span class="n">QSV1Formatter</span>

    <span class="n">formatter</span> <span class="o">=</span> <span class="n">QSV1Formatter</span><span class="p">(</span><span class="n">entity_labels</span><span class="o">=</span><span class="n">entity_labels</span> <span class="ow">or</span> <span class="p">{})</span>
    <span class="k">return</span> <span class="n">formatter</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">for_new_item</span><span class="o">=</span><span class="n">for_new_item</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataTemplate.to_shell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_shell</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Strip identifiers and metadata to create a shell for new item creation.</p>
<p>Returns entity data with all system IDs, metadata, and hashes removed,
suitable for use as a template for creating new items.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict with identifiers stripped, ready for new item creation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Prepare this template as a clean shell for a new item.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_shell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Strip identifiers and metadata to create a shell for new item creation.</span>

<span class="sd">    Returns entity data with all system IDs, metadata, and hashes removed,</span>
<span class="sd">    suitable for use as a template for creating new items.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict with identifiers stripped, ready for new item creation.</span>

<span class="sd">    Plain meaning: Prepare this template as a clean shell for a new item.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">strip_entity_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataTemplate.to_simple_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_simple_dict</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Serialize to a simplified dictionary.</p>
<p>Plain meaning: Convert to a compact summary structure.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_simple_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialize to a simplified dictionary.</span>

<span class="sd">    Plain meaning: Convert to a compact summary structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;qid&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">qid</span><span class="p">,</span>
        <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
        <span class="s2">&quot;descriptions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="p">,</span>
        <span class="s2">&quot;aliases&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="p">,</span>
        <span class="s2">&quot;claims&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;property_id&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">property_id</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="s2">&quot;qualifiers&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">qualifiers</span><span class="p">,</span>
                <span class="s2">&quot;references&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">references</span><span class="p">,</span>
                <span class="s2">&quot;rank&quot;</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">rank</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">claims</span>
        <span class="p">],</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="wikidatapropertytemplate">WikidataPropertyTemplate</h3>


<div class="doc doc-object doc-class">



<a id="gkc.mash.WikidataPropertyTemplate"></a>
    <div class="doc doc-contents first">


        <p>An extracted Wikidata property ready for filtering and export.</p>
<p>This is the property-specific implementation of the DataTemplate protocol.</p>
<p>Plain meaning: A loaded Wikidata property template ready for modification.</p>






              <details class="quote">
                <summary>Source code in <code>gkc/mash.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">WikidataPropertyTemplate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An extracted Wikidata property ready for filtering and export.</span>

<span class="sd">    This is the property-specific implementation of the DataTemplate protocol.</span>

<span class="sd">    Plain meaning: A loaded Wikidata property template ready for modification.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pid</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="n">descriptions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="n">aliases</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="n">datatype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">formatter_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">entity_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_languages</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">languages</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter labels, descriptions, and aliases to specified languages.</span>

<span class="sd">        Args:</span>
<span class="sd">            languages: Either:</span>
<span class="sd">                - A single language code (e.g., &quot;en&quot;)</span>
<span class="sd">                - A list of language codes (e.g., [&quot;en&quot;, &quot;es&quot;, &quot;fr&quot;])</span>
<span class="sd">                - The string &quot;all&quot; to keep all languages</span>
<span class="sd">                - None to use the package-level language configuration</span>

<span class="sd">        Plain meaning: Keep only the specified language versions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">gkc</span>

        <span class="k">if</span> <span class="n">languages</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">languages</span> <span class="o">=</span> <span class="n">gkc</span><span class="o">.</span><span class="n">get_languages</span><span class="p">()</span>

        <span class="c1"># If &quot;all&quot;, don&#39;t filter anything</span>
        <span class="k">if</span> <span class="n">languages</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Convert single string to list for uniform handling</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">languages</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">languages</span> <span class="o">=</span> <span class="p">[</span><span class="n">languages</span><span class="p">]</span>

        <span class="c1"># Filter each field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">}</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
            <span class="p">}</span>

        <span class="n">descriptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;descriptions&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">descriptions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;descriptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
            <span class="p">}</span>

        <span class="n">aliases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aliases&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aliases</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">aliases</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
            <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a summary of the template for display.</span>

<span class="sd">        Plain meaning: Get a quick overview without full details.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;pid&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span>
            <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
            <span class="s2">&quot;descriptions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="p">,</span>
            <span class="s2">&quot;datatype&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="p">,</span>
            <span class="s2">&quot;formatter_url&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">formatter_url</span><span class="p">,</span>
            <span class="s2">&quot;aliases&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Serialize to a dictionary.</span>

<span class="sd">        Plain meaning: Convert to a form suitable for JSON export.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_shell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Strip identifiers and metadata to create a shell for new property creation.</span>

<span class="sd">        Returns entity data with all system IDs, metadata, and hashes removed,</span>
<span class="sd">        suitable for use as a template for creating new properties.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict with identifiers stripped, ready for new property creation.</span>

<span class="sd">        Plain meaning: Prepare this template as a clean shell for a new property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">strip_entity_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_gkc_entity_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to GKC Entity Profile format.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict representing the GKC Entity Profile.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: This transformation is not yet implemented</span>
<span class="sd">                for properties.</span>

<span class="sd">        Plain meaning: Transform into a GKC Entity Profile</span>
<span class="sd">            (not yet implemented).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;Property to GKC Entity Profile transformation is not yet implemented. &quot;</span>
            <span class="s2">&quot;This will be added in a future version.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataPropertyTemplate.filter_languages" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_languages</span><span class="p">(</span><span class="n">languages</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Filter labels, descriptions, and aliases to specified languages.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>languages</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="list">list</span>[<span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either:
- A single language code (e.g., "en")
- A list of language codes (e.g., ["en", "es", "fr"])
- The string "all" to keep all languages
- None to use the package-level language configuration</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Keep only the specified language versions.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_languages</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">languages</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter labels, descriptions, and aliases to specified languages.</span>

<span class="sd">    Args:</span>
<span class="sd">        languages: Either:</span>
<span class="sd">            - A single language code (e.g., &quot;en&quot;)</span>
<span class="sd">            - A list of language codes (e.g., [&quot;en&quot;, &quot;es&quot;, &quot;fr&quot;])</span>
<span class="sd">            - The string &quot;all&quot; to keep all languages</span>
<span class="sd">            - None to use the package-level language configuration</span>

<span class="sd">    Plain meaning: Keep only the specified language versions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">gkc</span>

    <span class="k">if</span> <span class="n">languages</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">languages</span> <span class="o">=</span> <span class="n">gkc</span><span class="o">.</span><span class="n">get_languages</span><span class="p">()</span>

    <span class="c1"># If &quot;all&quot;, don&#39;t filter anything</span>
    <span class="k">if</span> <span class="n">languages</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="c1"># Convert single string to list for uniform handling</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">languages</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">languages</span> <span class="o">=</span> <span class="p">[</span><span class="n">languages</span><span class="p">]</span>

    <span class="c1"># Filter each field</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">}</span>

    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
        <span class="p">}</span>

    <span class="n">descriptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;descriptions&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">descriptions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;descriptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
        <span class="p">}</span>

    <span class="n">aliases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aliases&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">aliases</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;aliases&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">aliases</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataPropertyTemplate.summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summary</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a summary of the template for display.</p>
<p>Plain meaning: Get a quick overview without full details.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a summary of the template for display.</span>

<span class="sd">    Plain meaning: Get a quick overview without full details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;pid&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span>
        <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
        <span class="s2">&quot;descriptions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="p">,</span>
        <span class="s2">&quot;datatype&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="p">,</span>
        <span class="s2">&quot;formatter_url&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">formatter_url</span><span class="p">,</span>
        <span class="s2">&quot;aliases&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataPropertyTemplate.to_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dict</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Serialize to a dictionary.</p>
<p>Plain meaning: Convert to a form suitable for JSON export.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialize to a dictionary.</span>

<span class="sd">    Plain meaning: Convert to a form suitable for JSON export.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataPropertyTemplate.to_gkc_entity_profile" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_gkc_entity_profile</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Convert to GKC Entity Profile format.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict representing the GKC Entity Profile.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This transformation is not yet implemented
for properties.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="plain-meaning" open>
  <summary>Transform into a GKC Entity Profile</summary>
  <p>(not yet implemented).</p>
</details>
            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_gkc_entity_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to GKC Entity Profile format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict representing the GKC Entity Profile.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: This transformation is not yet implemented</span>
<span class="sd">            for properties.</span>

<span class="sd">    Plain meaning: Transform into a GKC Entity Profile</span>
<span class="sd">        (not yet implemented).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
        <span class="s2">&quot;Property to GKC Entity Profile transformation is not yet implemented. &quot;</span>
        <span class="s2">&quot;This will be added in a future version.&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataPropertyTemplate.to_shell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_shell</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Strip identifiers and metadata to create a shell for new property creation.</p>
<p>Returns entity data with all system IDs, metadata, and hashes removed,
suitable for use as a template for creating new properties.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict with identifiers stripped, ready for new property creation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Prepare this template as a clean shell for a new property.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_shell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Strip identifiers and metadata to create a shell for new property creation.</span>

<span class="sd">    Returns entity data with all system IDs, metadata, and hashes removed,</span>
<span class="sd">    suitable for use as a template for creating new properties.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict with identifiers stripped, ready for new property creation.</span>

<span class="sd">    Plain meaning: Prepare this template as a clean shell for a new property.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">strip_entity_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="wikidataentityschematemplate">WikidataEntitySchemaTemplate</h3>


<div class="doc doc-object doc-class">



<a id="gkc.mash.WikidataEntitySchemaTemplate"></a>
    <div class="doc doc-contents first">


        <p>An extracted Wikidata EntitySchema ready for filtering and export.</p>
<p>This is the EntitySchema-specific implementation of the DataTemplate protocol.</p>
<p>Plain meaning: A loaded Wikidata EntitySchema template ready for modification.</p>






              <details class="quote">
                <summary>Source code in <code>gkc/mash.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">WikidataEntitySchemaTemplate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An extracted Wikidata EntitySchema ready for filtering and export.</span>

<span class="sd">    This is the EntitySchema-specific implementation of the DataTemplate protocol.</span>

<span class="sd">    Plain meaning: A loaded Wikidata EntitySchema template ready for modification.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">eid</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">labels</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="n">descriptions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="n">schema_text</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">entity_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_languages</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">languages</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter labels and descriptions to specified languages.</span>

<span class="sd">        Args:</span>
<span class="sd">            languages: Either:</span>
<span class="sd">                - A single language code (e.g., &quot;en&quot;)</span>
<span class="sd">                - A list of language codes (e.g., [&quot;en&quot;, &quot;es&quot;, &quot;fr&quot;])</span>
<span class="sd">                - The string &quot;all&quot; to keep all languages</span>
<span class="sd">                - None to use the package-level language configuration</span>

<span class="sd">        Plain meaning: Keep only the specified language versions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">gkc</span>

        <span class="k">if</span> <span class="n">languages</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">languages</span> <span class="o">=</span> <span class="n">gkc</span><span class="o">.</span><span class="n">get_languages</span><span class="p">()</span>

        <span class="c1"># If &quot;all&quot;, don&#39;t filter anything</span>
        <span class="k">if</span> <span class="n">languages</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Convert single string to list for uniform handling</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">languages</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">languages</span> <span class="o">=</span> <span class="p">[</span><span class="n">languages</span><span class="p">]</span>

        <span class="c1"># Filter each field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span>
        <span class="p">}</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
            <span class="p">}</span>

        <span class="n">descriptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;descriptions&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">descriptions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;descriptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
            <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a summary of the template for display.</span>

<span class="sd">        Plain meaning: Get a quick overview without full details.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;eid&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid</span><span class="p">,</span>
            <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
            <span class="s2">&quot;descriptions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="p">,</span>
            <span class="s2">&quot;schema_text_length&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schema_text</span><span class="p">),</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Serialize to a dictionary.</span>

<span class="sd">        Plain meaning: Convert to a form suitable for JSON export.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_shell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Strip identifiers and metadata for new EntitySchema creation.</span>

<span class="sd">        Returns entity data with all system IDs and metadata removed,</span>
<span class="sd">        suitable for use as a template for creating new EntitySchemas.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict with identifiers stripped, ready for new EntitySchema creation.</span>

<span class="sd">        Plain meaning: Prepare this template as a clean shell for a new EntitySchema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">strip_entity_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_gkc_entity_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to GKC Entity Profile format.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict representing the GKC Entity Profile.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: EntitySchema to Entity Profile transformation</span>
<span class="sd">                is not yet supported. This functionality will be restored</span>
<span class="sd">                when the new Entity Profile architecture is finalized.</span>

<span class="sd">        Plain meaning: Transform into a GKC Entity Profile (not yet supported).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;EntitySchema to GKC Entity Profile transformation is not yet supported. &quot;</span>
            <span class="s2">&quot;This functionality will be restored when the new Entity Profile &quot;</span>
            <span class="s2">&quot;architecture is finalized.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataEntitySchemaTemplate.filter_languages" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_languages</span><span class="p">(</span><span class="n">languages</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Filter labels and descriptions to specified languages.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>languages</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="list">list</span>[<span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either:
- A single language code (e.g., "en")
- A list of language codes (e.g., ["en", "es", "fr"])
- The string "all" to keep all languages
- None to use the package-level language configuration</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Keep only the specified language versions.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_languages</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">languages</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter labels and descriptions to specified languages.</span>

<span class="sd">    Args:</span>
<span class="sd">        languages: Either:</span>
<span class="sd">            - A single language code (e.g., &quot;en&quot;)</span>
<span class="sd">            - A list of language codes (e.g., [&quot;en&quot;, &quot;es&quot;, &quot;fr&quot;])</span>
<span class="sd">            - The string &quot;all&quot; to keep all languages</span>
<span class="sd">            - None to use the package-level language configuration</span>

<span class="sd">    Plain meaning: Keep only the specified language versions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">gkc</span>

    <span class="k">if</span> <span class="n">languages</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">languages</span> <span class="o">=</span> <span class="n">gkc</span><span class="o">.</span><span class="n">get_languages</span><span class="p">()</span>

    <span class="c1"># If &quot;all&quot;, don&#39;t filter anything</span>
    <span class="k">if</span> <span class="n">languages</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="c1"># Convert single string to list for uniform handling</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">languages</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">languages</span> <span class="o">=</span> <span class="p">[</span><span class="n">languages</span><span class="p">]</span>

    <span class="c1"># Filter each field</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">languages</span>
    <span class="p">}</span>

    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
        <span class="p">}</span>

    <span class="n">descriptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;descriptions&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">descriptions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">[</span><span class="s2">&quot;descriptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">lang</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">lang</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataEntitySchemaTemplate.summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summary</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a summary of the template for display.</p>
<p>Plain meaning: Get a quick overview without full details.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a summary of the template for display.</span>

<span class="sd">    Plain meaning: Get a quick overview without full details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;eid&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid</span><span class="p">,</span>
        <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
        <span class="s2">&quot;descriptions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptions</span><span class="p">,</span>
        <span class="s2">&quot;schema_text_length&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schema_text</span><span class="p">),</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataEntitySchemaTemplate.to_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dict</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Serialize to a dictionary.</p>
<p>Plain meaning: Convert to a form suitable for JSON export.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialize to a dictionary.</span>

<span class="sd">    Plain meaning: Convert to a form suitable for JSON export.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataEntitySchemaTemplate.to_gkc_entity_profile" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_gkc_entity_profile</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Convert to GKC Entity Profile format.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict representing the GKC Entity Profile.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>EntitySchema to Entity Profile transformation
is not yet supported. This functionality will be restored
when the new Entity Profile architecture is finalized.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Transform into a GKC Entity Profile (not yet supported).</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_gkc_entity_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to GKC Entity Profile format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict representing the GKC Entity Profile.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: EntitySchema to Entity Profile transformation</span>
<span class="sd">            is not yet supported. This functionality will be restored</span>
<span class="sd">            when the new Entity Profile architecture is finalized.</span>

<span class="sd">    Plain meaning: Transform into a GKC Entity Profile (not yet supported).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
        <span class="s2">&quot;EntitySchema to GKC Entity Profile transformation is not yet supported. &quot;</span>
        <span class="s2">&quot;This functionality will be restored when the new Entity Profile &quot;</span>
        <span class="s2">&quot;architecture is finalized.&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikidataEntitySchemaTemplate.to_shell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_shell</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Strip identifiers and metadata for new EntitySchema creation.</p>
<p>Returns entity data with all system IDs and metadata removed,
suitable for use as a template for creating new EntitySchemas.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict with identifiers stripped, ready for new EntitySchema creation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Prepare this template as a clean shell for a new EntitySchema.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_shell</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Strip identifiers and metadata for new EntitySchema creation.</span>

<span class="sd">    Returns entity data with all system IDs and metadata removed,</span>
<span class="sd">    suitable for use as a template for creating new EntitySchemas.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict with identifiers stripped, ready for new EntitySchema creation.</span>

<span class="sd">    Plain meaning: Prepare this template as a clean shell for a new EntitySchema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">strip_entity_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="wikipedialoader">WikipediaLoader</h3>


<div class="doc doc-object doc-class">



<a id="gkc.mash.WikipediaLoader"></a>
    <div class="doc doc-contents first">


        <p>Load Wikipedia templates from Wikimedia API as templates for editing workflows.</p>
<p>This is the Wikipedia-specific implementation of a data loader.</p>
<p>Plain meaning: Fetch and parse a Wikipedia template into a usable format.</p>






              <details class="quote">
                <summary>Source code in <code>gkc/mash.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">WikipediaLoader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load Wikipedia templates from Wikimedia API as templates for editing workflows.</span>

<span class="sd">    This is the Wikipedia-specific implementation of a data loader.</span>

<span class="sd">    Plain meaning: Fetch and parse a Wikipedia template into a usable format.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_agent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the loader.</span>

<span class="sd">        Args:</span>
<span class="sd">            user_agent: Custom user agent for Wikimedia API requests.</span>
<span class="sd">                       If not provided, a default GKC user agent is used.</span>

<span class="sd">        Plain meaning: Set up the loader with optional custom user agent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">user_agent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">user_agent</span> <span class="o">=</span> <span class="s2">&quot;GKC/1.0 (https://github.com/skybristol/gkc; data integration)&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="n">user_agent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://en.wikipedia.org/w/api.php&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikipediaTemplate</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a Wikipedia template and return it as a template.</span>

<span class="sd">        Args:</span>
<span class="sd">            template_name: The Wikipedia template name (e.g., &#39;Infobox settlement&#39;).</span>

<span class="sd">        Returns:</span>
<span class="sd">            WikipediaTemplate with the template&#39;s structure.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the template cannot be fetched or parsed.</span>

<span class="sd">        Plain meaning: Retrieve the template and return it ready for use.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; loader = WikipediaLoader()</span>
<span class="sd">            &gt;&gt;&gt; template = loader.load_template(&quot;Infobox settlement&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(template.summary())</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Fetch template data from Wikimedia API</span>
        <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;templatedata&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
            <span class="s2">&quot;titles&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Template:</span><span class="si">{</span><span class="n">template_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="p">,</span>
                <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="p">},</span>
                <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Failed to fetch template &#39;</span><span class="si">{</span><span class="n">template_name</span><span class="si">}</span><span class="s2">&#39; from Wikimedia API: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Failed to parse JSON response for template &#39;</span><span class="si">{</span><span class="n">template_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>

        <span class="c1"># Extract pages from response. The templatedata API returns pages directly,</span>
        <span class="c1"># not nested under a &quot;query&quot; key like other Mediawiki APIs.</span>
        <span class="n">pages</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pages</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Template &#39;</span><span class="si">{</span><span class="n">template_name</span><span class="si">}</span><span class="s2">&#39; not found in Wikimedia API response&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Get the first (and only) page</span>
        <span class="n">page_data</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">pages</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

        <span class="c1"># Check if this page has template data</span>
        <span class="k">if</span> <span class="s2">&quot;notabledescriptions&quot;</span> <span class="ow">in</span> <span class="n">page_data</span> <span class="ow">or</span> <span class="s2">&quot;missing&quot;</span> <span class="ow">in</span> <span class="n">page_data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Template &#39;</span><span class="si">{</span><span class="n">template_name</span><span class="si">}</span><span class="s2">&#39; not found or has no template data&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Extract required fields</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">page_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">template_name</span><span class="p">)</span>

        <span class="c1"># Get description in English, or empty string if not available</span>
        <span class="n">descriptions</span> <span class="o">=</span> <span class="n">page_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">descriptions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">descriptions</span><span class="p">)</span> <span class="k">if</span> <span class="n">descriptions</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

        <span class="n">params_data</span> <span class="o">=</span> <span class="n">page_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;params&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">param_order</span> <span class="o">=</span> <span class="n">page_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;paramOrder&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="c1"># Build and return the template</span>
        <span class="k">return</span> <span class="n">WikipediaTemplate</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params_data</span><span class="p">,</span>
            <span class="n">param_order</span><span class="o">=</span><span class="n">param_order</span><span class="p">,</span>
            <span class="n">raw_data</span><span class="o">=</span><span class="n">page_data</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikipediaLoader.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">user_agent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initialize the loader.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>user_agent</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom user agent for Wikimedia API requests.
       If not provided, a default GKC user agent is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Set up the loader with optional custom user agent.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_agent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the loader.</span>

<span class="sd">    Args:</span>
<span class="sd">        user_agent: Custom user agent for Wikimedia API requests.</span>
<span class="sd">                   If not provided, a default GKC user agent is used.</span>

<span class="sd">    Plain meaning: Set up the loader with optional custom user agent.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">user_agent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">user_agent</span> <span class="o">=</span> <span class="s2">&quot;GKC/1.0 (https://github.com/skybristol/gkc; data integration)&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="n">user_agent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://en.wikipedia.org/w/api.php&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikipediaLoader.load_template" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_template</span><span class="p">(</span><span class="n">template_name</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Load a Wikipedia template and return it as a template.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>template_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Wikipedia template name (e.g., 'Infobox settlement').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="gkc.mash.WikipediaTemplate" href="#gkc.mash.WikipediaTemplate">WikipediaTemplate</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>WikipediaTemplate with the template's structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the template cannot be fetched or parsed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Retrieve the template and return it ready for use.</p>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>loader = WikipediaLoader()
template = loader.load_template("Infobox settlement")
print(template.summary())</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WikipediaTemplate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a Wikipedia template and return it as a template.</span>

<span class="sd">    Args:</span>
<span class="sd">        template_name: The Wikipedia template name (e.g., &#39;Infobox settlement&#39;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        WikipediaTemplate with the template&#39;s structure.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the template cannot be fetched or parsed.</span>

<span class="sd">    Plain meaning: Retrieve the template and return it ready for use.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; loader = WikipediaLoader()</span>
<span class="sd">        &gt;&gt;&gt; template = loader.load_template(&quot;Infobox settlement&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(template.summary())</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Fetch template data from Wikimedia API</span>
    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;templatedata&quot;</span><span class="p">,</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
        <span class="s2">&quot;titles&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Template:</span><span class="si">{</span><span class="n">template_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="p">},</span>
            <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Failed to fetch template &#39;</span><span class="si">{</span><span class="n">template_name</span><span class="si">}</span><span class="s2">&#39; from Wikimedia API: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Failed to parse JSON response for template &#39;</span><span class="si">{</span><span class="n">template_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>

    <span class="c1"># Extract pages from response. The templatedata API returns pages directly,</span>
    <span class="c1"># not nested under a &quot;query&quot; key like other Mediawiki APIs.</span>
    <span class="n">pages</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pages</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Template &#39;</span><span class="si">{</span><span class="n">template_name</span><span class="si">}</span><span class="s2">&#39; not found in Wikimedia API response&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Get the first (and only) page</span>
    <span class="n">page_data</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">pages</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="c1"># Check if this page has template data</span>
    <span class="k">if</span> <span class="s2">&quot;notabledescriptions&quot;</span> <span class="ow">in</span> <span class="n">page_data</span> <span class="ow">or</span> <span class="s2">&quot;missing&quot;</span> <span class="ow">in</span> <span class="n">page_data</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Template &#39;</span><span class="si">{</span><span class="n">template_name</span><span class="si">}</span><span class="s2">&#39; not found or has no template data&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Extract required fields</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">page_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="n">template_name</span><span class="p">)</span>

    <span class="c1"># Get description in English, or empty string if not available</span>
    <span class="n">descriptions</span> <span class="o">=</span> <span class="n">page_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">descriptions</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">descriptions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">description</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">descriptions</span><span class="p">)</span> <span class="k">if</span> <span class="n">descriptions</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

    <span class="n">params_data</span> <span class="o">=</span> <span class="n">page_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;params&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">param_order</span> <span class="o">=</span> <span class="n">page_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;paramOrder&quot;</span><span class="p">,</span> <span class="p">[])</span>

    <span class="c1"># Build and return the template</span>
    <span class="k">return</span> <span class="n">WikipediaTemplate</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="n">params_data</span><span class="p">,</span>
        <span class="n">param_order</span><span class="o">=</span><span class="n">param_order</span><span class="p">,</span>
        <span class="n">raw_data</span><span class="o">=</span><span class="n">page_data</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="wikipediatemplate">WikipediaTemplate</h3>


<div class="doc doc-object doc-class">



<a id="gkc.mash.WikipediaTemplate"></a>
    <div class="doc doc-contents first">


        <p>A Wikipedia template loaded from Wikimedia API for use in Wikipedia editing.</p>
<p>This is the Wikipedia-specific implementation of the DataTemplate protocol.</p>
<p>Plain meaning: A loaded Wikipedia template ready for display and use
in editing workflows.</p>






              <details class="quote">
                <summary>Source code in <code>gkc/mash.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">WikipediaTemplate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A Wikipedia template loaded from Wikimedia API for use in Wikipedia editing.</span>

<span class="sd">    This is the Wikipedia-specific implementation of the DataTemplate protocol.</span>

<span class="sd">    Plain meaning: A loaded Wikipedia template ready for display and use</span>
<span class="sd">    in editing workflows.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="n">param_order</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">raw_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a summary of the template for display.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict with title, description, and number of parameters.</span>

<span class="sd">        Plain meaning: Get a quick overview without full details.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;param_count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">),</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Serialize to a dictionary.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict containing title, description, params, and paramOrder.</span>

<span class="sd">        Plain meaning: Convert to a form suitable for JSON export.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
            <span class="s2">&quot;paramOrder&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_order</span><span class="p">,</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikipediaTemplate.summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summary</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a summary of the template for display.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict with title, description, and number of parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Get a quick overview without full details.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a summary of the template for display.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict with title, description, and number of parameters.</span>

<span class="sd">    Plain meaning: Get a quick overview without full details.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
        <span class="s2">&quot;param_count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">),</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="gkc.mash.WikipediaTemplate.to_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dict</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Serialize to a dictionary.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict containing title, description, params, and paramOrder.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Convert to a form suitable for JSON export.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serialize to a dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict containing title, description, params, and paramOrder.</span>

<span class="sd">    Plain meaning: Convert to a form suitable for JSON export.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
        <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
        <span class="s2">&quot;paramOrder&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_order</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="utility-functions">Utility Functions</h2>
<h3 id="strip_entity_identifiers">strip_entity_identifiers()</h3>


<div class="doc doc-object doc-function">



<a id="gkc.mash.strip_entity_identifiers"></a>
    <div class="doc doc-contents first">

        <p>Return a copy of entity data with identifiers stripped for new-item use.</p>
<p>Removes fields that prevent using the JSON as a new item template:
- Item-level: id, pageid, lastrevid, modified, ns, title
- Statement-level: id (statement GUID)
- Snak-level: hash (in mainsnak, qualifiers, and references)</p>
<p>Plain meaning: Remove IDs that prevent using the JSON as a new item template.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">strip_entity_identifiers</span><span class="p">(</span><span class="n">entity_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a copy of entity data with identifiers stripped for new-item use.</span>

<span class="sd">    Removes fields that prevent using the JSON as a new item template:</span>
<span class="sd">    - Item-level: id, pageid, lastrevid, modified, ns, title</span>
<span class="sd">    - Statement-level: id (statement GUID)</span>
<span class="sd">    - Snak-level: hash (in mainsnak, qualifiers, and references)</span>

<span class="sd">    Plain meaning: Remove IDs that prevent using the JSON as a new item template.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cleaned</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">entity_data</span><span class="p">)</span>

    <span class="c1"># Remove item-level identifiers and metadata</span>
    <span class="n">cleaned</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">cleaned</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;pageid&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">cleaned</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;lastrevid&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">cleaned</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;modified&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">cleaned</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ns&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">cleaned</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Remove statement-level identifiers and hashes</span>
    <span class="n">claims</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;claims&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">statements</span> <span class="ow">in</span> <span class="n">claims</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">statements</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">statement</span> <span class="ow">in</span> <span class="n">statements</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">statement</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

                    <span class="c1"># Remove hash from mainsnak</span>
                    <span class="n">mainsnak</span> <span class="o">=</span> <span class="n">statement</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mainsnak&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mainsnak</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="n">mainsnak</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;hash&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

                    <span class="c1"># Remove hash from qualifiers</span>
                    <span class="n">qualifiers</span> <span class="o">=</span> <span class="n">statement</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;qualifiers&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qualifiers</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">qualifier_snaks</span> <span class="ow">in</span> <span class="n">qualifiers</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">qualifier_snaks</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                                <span class="k">for</span> <span class="n">snak</span> <span class="ow">in</span> <span class="n">qualifier_snaks</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snak</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                                        <span class="n">snak</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;hash&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

                    <span class="c1"># Remove hash from references</span>
                    <span class="n">references</span> <span class="o">=</span> <span class="n">statement</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;references&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">references</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">reference</span> <span class="ow">in</span> <span class="n">references</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                                <span class="n">reference</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;hash&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                                <span class="n">ref_snaks</span> <span class="o">=</span> <span class="n">reference</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;snaks&quot;</span><span class="p">)</span>
                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref_snaks</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                                    <span class="k">for</span> <span class="n">ref_snak_list</span> <span class="ow">in</span> <span class="n">ref_snaks</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref_snak_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                                            <span class="k">for</span> <span class="n">snak</span> <span class="ow">in</span> <span class="n">ref_snak_list</span><span class="p">:</span>
                                                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">snak</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                                                    <span class="n">snak</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;hash&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cleaned</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="fetch_property_labels">fetch_property_labels()</h3>


<div class="doc doc-object doc-function">



<a id="gkc.mash.fetch_property_labels"></a>
    <div class="doc doc-contents first">

        <p>Fetch human-readable labels for Wikidata properties using SPARQL.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>property_ids</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of property IDs (e.g., ['P31', 'P21']).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>language</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Language code for labels (defaults to package configuration).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict mapping property IDs to their labels (e.g., {'P31': 'instance of'}).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Plain meaning: Look up property names efficiently to make QS output more readable.</p>

            <details class="quote">
              <summary>Source code in <code>gkc/mash.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fetch_property_labels</span><span class="p">(</span>
    <span class="n">property_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">language</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetch human-readable labels for Wikidata properties using SPARQL.</span>

<span class="sd">    Args:</span>
<span class="sd">        property_ids: List of property IDs (e.g., [&#39;P31&#39;, &#39;P21&#39;]).</span>
<span class="sd">        language: Language code for labels (defaults to package configuration).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict mapping property IDs to their labels (e.g., {&#39;P31&#39;: &#39;instance of&#39;}).</span>

<span class="sd">    Plain meaning: Look up property names efficiently to make QS output more readable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">property_ids</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">language</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">gkc</span>

        <span class="n">languages</span> <span class="o">=</span> <span class="n">gkc</span><span class="o">.</span><span class="n">get_languages</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">languages</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="n">language</span> <span class="o">=</span> <span class="s2">&quot;en&quot;</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">languages</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">language</span> <span class="o">=</span> <span class="n">languages</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">language</span> <span class="o">=</span> <span class="n">languages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">languages</span> <span class="k">else</span> <span class="s2">&quot;en&quot;</span>
    <span class="k">return</span> <span class="n">fetch_entity_labels</span><span class="p">(</span><span class="n">property_ids</span><span class="p">,</span> <span class="n">languages</span><span class="o">=</span><span class="p">[</span><span class="n">language</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><hr />
<h2 id="data-classes">Data Classes</h2>
<h3 id="claimsummary">ClaimSummary</h3>


<div class="doc doc-object doc-class">



<a id="gkc.mash.ClaimSummary"></a>
    <div class="doc doc-contents first">


        <p>Simplified representation of a Wikidata claim for display and export.</p>
<p>Plain meaning: A simple view of a claim without requiring RDF knowledge.</p>






              <details class="quote">
                <summary>Source code in <code>gkc/mash.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ClaimSummary</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simplified representation of a Wikidata claim for display and export.</span>

<span class="sd">    Plain meaning: A simple view of a claim without requiring RDF knowledge.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">property_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">qualifiers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">references</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">rank</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;normal&quot;</span>
    <span class="n">value_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div><hr />
<h2 id="examples">Examples</h2>
<h3 id="load-and-filter-a-wikidata-item">Load and filter a Wikidata item</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikidataLoader</span>

<span class="c1"># Initialize the loader</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="p">()</span>

<span class="c1"># Load an item</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_item</span><span class="p">(</span><span class="s2">&quot;Q42&quot;</span><span class="p">)</span>  <span class="c1"># Douglas Adams</span>

<span class="c1"># Filter to English only</span>
<span class="n">template</span><span class="o">.</span><span class="n">filter_languages</span><span class="p">(</span><span class="s2">&quot;en&quot;</span><span class="p">)</span>

<span class="c1"># Exclude certain properties</span>
<span class="n">template</span><span class="o">.</span><span class="n">filter_properties</span><span class="p">(</span><span class="n">exclude_properties</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;P18&quot;</span><span class="p">,</span> <span class="s2">&quot;P373&quot;</span><span class="p">])</span>

<span class="c1"># Remove qualifiers and references for simplicity</span>
<span class="n">template</span><span class="o">.</span><span class="n">filter_qualifiers</span><span class="p">()</span>
<span class="n">template</span><span class="o">.</span><span class="n">filter_references</span><span class="p">()</span>

<span class="c1"># Get a summary</span>
<span class="n">summary</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;qid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total statements: </span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;total_statements&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="load-multiple-items-in-batch">Load multiple items in batch</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikidataLoader</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="p">()</span>

<span class="c1"># Load multiple items efficiently</span>
<span class="n">qids</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Q42&quot;</span><span class="p">,</span> <span class="s2">&quot;Q5&quot;</span><span class="p">,</span> <span class="s2">&quot;Q30&quot;</span><span class="p">,</span> <span class="s2">&quot;Q515&quot;</span><span class="p">]</span>
<span class="n">templates</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_items</span><span class="p">(</span><span class="n">qids</span><span class="p">)</span>

<span class="k">for</span> <span class="n">qid</span><span class="p">,</span> <span class="n">template</span> <span class="ow">in</span> <span class="n">templates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">qid</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">template</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;No label&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="prepare-entity-data-for-new-item-creation">Prepare entity data for new item creation</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikidataLoader</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="p">()</span>

<span class="c1"># Load an item</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_item</span><span class="p">(</span><span class="s2">&quot;Q42&quot;</span><span class="p">)</span>

<span class="c1"># Strip identifiers to prepare for creating a new item</span>
<span class="n">new_item_data</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">to_shell</span><span class="p">()</span>

<span class="c1"># Now you can modify labels, claims, etc. and use this for a new item</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">new_item_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div>
<h3 id="convert-item-to-quickstatements-format">Convert item to QuickStatements format</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikidataLoader</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="p">()</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_item</span><span class="p">(</span><span class="s2">&quot;Q42&quot;</span><span class="p">)</span>

<span class="c1"># For updating existing item</span>
<span class="n">qs_update</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">to_qsv1</span><span class="p">(</span><span class="n">for_new_item</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qs_update</span><span class="p">)</span>

<span class="c1"># For creating new item (uses CREATE/LAST syntax)</span>
<span class="n">qs_new</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">to_qsv1</span><span class="p">(</span><span class="n">for_new_item</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qs_new</span><span class="p">)</span>

<span class="c1"># With entity labels as comments</span>
<span class="n">entity_labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;P31&quot;</span><span class="p">:</span> <span class="s2">&quot;instance of&quot;</span><span class="p">,</span> <span class="s2">&quot;Q5&quot;</span><span class="p">:</span> <span class="s2">&quot;human&quot;</span><span class="p">}</span>
<span class="n">qs_labeled</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">to_qsv1</span><span class="p">(</span><span class="n">entity_labels</span><span class="o">=</span><span class="n">entity_labels</span><span class="p">)</span>
</code></pre></div>
<h3 id="load-and-work-with-properties">Load and work with properties</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikidataLoader</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="p">()</span>

<span class="c1"># Load a single property</span>
<span class="n">prop</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_property</span><span class="p">(</span><span class="s2">&quot;P31&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datatype: </span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">datatype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Labels: </span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">labels</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Load multiple properties in batch</span>
<span class="n">pids</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;P31&quot;</span><span class="p">,</span> <span class="s2">&quot;P279&quot;</span><span class="p">,</span> <span class="s2">&quot;P21&quot;</span><span class="p">]</span>
<span class="n">props</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_properties</span><span class="p">(</span><span class="n">pids</span><span class="p">)</span>

<span class="k">for</span> <span class="n">pid</span><span class="p">,</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">props</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">datatype</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="load-and-transform-entityschemas">Load and transform EntitySchemas</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikidataLoader</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="p">()</span>

<span class="c1"># Load an EntitySchema</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_entity_schema</span><span class="p">(</span><span class="s2">&quot;E502&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Schema: </span><span class="si">{</span><span class="n">schema</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;en&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ShEx text length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">schema_text</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Convert to GKC Entity Profile</span>
<span class="n">profile</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">to_gkc_entity_profile</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span>
</code></pre></div>
<h3 id="fetch-descriptors-for-mixed-entities">Fetch descriptors for mixed entities</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikidataLoader</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="p">()</span>

<span class="c1"># Get labels and descriptions for a mix of items and properties</span>
<span class="n">entity_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Q42&quot;</span><span class="p">,</span> <span class="s2">&quot;P31&quot;</span><span class="p">,</span> <span class="s2">&quot;Q5&quot;</span><span class="p">,</span> <span class="s2">&quot;P279&quot;</span><span class="p">]</span>
<span class="n">descriptors</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">fetch_descriptors</span><span class="p">(</span><span class="n">entity_ids</span><span class="p">)</span>

<span class="k">for</span> <span class="n">eid</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">descriptors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="s2">&quot;No label&quot;</span><span class="p">)</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;descriptions&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="s2">&quot;No description&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">eid</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="work-with-multiple-language-versions">Work with multiple language versions</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikidataLoader</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gkc</span>

<span class="c1"># Set package-level language configuration</span>
<span class="n">gkc</span><span class="o">.</span><span class="n">set_languages</span><span class="p">([</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="s2">&quot;es&quot;</span><span class="p">,</span> <span class="s2">&quot;fr&quot;</span><span class="p">])</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="p">()</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_item</span><span class="p">(</span><span class="s2">&quot;Q42&quot;</span><span class="p">)</span>

<span class="c1"># Filter using package configuration</span>
<span class="n">template</span><span class="o">.</span><span class="n">filter_languages</span><span class="p">()</span>  <span class="c1"># Uses package setting</span>

<span class="c1"># Or specify explicitly</span>
<span class="n">template</span><span class="o">.</span><span class="n">filter_languages</span><span class="p">([</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="s2">&quot;de&quot;</span><span class="p">])</span>

<span class="c1"># Keep all languages</span>
<span class="n">template</span><span class="o">.</span><span class="n">filter_languages</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="load-with-custom-user-agent">Load with custom user agent</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikidataLoader</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="p">(</span>
    <span class="n">user_agent</span><span class="o">=</span><span class="s2">&quot;MyBot/1.0 (https://example.com; user@example.com)&quot;</span>
<span class="p">)</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_item</span><span class="p">(</span><span class="s2">&quot;Q42&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="load-and-examine-a-wikipedia-template">Load and examine a Wikipedia template</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikipediaLoader</span>

<span class="c1"># Initialize the loader for en.wikipedia.org</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">WikipediaLoader</span><span class="p">()</span>

<span class="c1"># Load a Wikipedia template</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_template</span><span class="p">(</span><span class="s2">&quot;Infobox settlement&quot;</span><span class="p">)</span>

<span class="c1"># Get a quick summary</span>
<span class="n">summary</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Template: </span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Description: </span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameters: </span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;param_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Get the full template structure</span>
<span class="n">full_data</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">param_name</span> <span class="ow">in</span> <span class="n">template</span><span class="o">.</span><span class="n">param_order</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>  <span class="c1"># First 5 parameters</span>
    <span class="n">param_info</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">param_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">param_name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">param_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="transformation-methods">Transformation Methods</h2>
<p>All template types support transformation methods for different output formats:</p>
<h3 id="to_dict">to_dict()</h3>
<p>Returns the raw Wikidata JSON structure, preserving all identifiers. Use this for round-trip processing where you need to preserve the exact structure.</p>
<h3 id="to_shell">to_shell()</h3>
<p>Strips all identifiers, hashes, and metadata from the entity data, creating a clean template for new entity creation. Removes: <code>id</code>, <code>pageid</code>, <code>lastrevid</code>, <code>modified</code>, <code>ns</code>, <code>title</code>, statement IDs, and all hashes.</p>
<h3 id="to_qsv1-items-only">to_qsv1() (Items only)</h3>
<p>Converts item templates to QuickStatements V1 format for bulk operations. Supports both update mode (uses QID) and creation mode (uses CREATE/LAST).</p>
<h3 id="to_gkc_entity_profile-entityschemas-only">to_gkc_entity_profile() (EntitySchemas only)</h3>
<p>Converts EntitySchema templates to GKC Entity Profile format. This transformation is implemented for EntitySchemas and will be added for items and properties in future versions.</p>
<hr />
<h2 id="error-handling">Error Handling</h2>
<h3 id="entity-not-found">Entity not found</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikidataLoader</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_item</span><span class="p">(</span><span class="s2">&quot;Q999999999999&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Error: no-such-entity: Q999999999999 not found on Wikidata</span>
</code></pre></div>
<h3 id="network-errors">Network errors</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">gkc.mash</span><span class="w"> </span><span class="kn">import</span> <span class="n">WikidataLoader</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">WikidataLoader</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_item</span><span class="p">(</span><span class="s2">&quot;Q42&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to fetch item: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="migration-from-previous-version">Migration from Previous Version</h2>
<p>The mash module has been refactored for consistency across entity types. Key changes:</p>
<ul>
<li><code>WikidataLoader.load(qid)</code> is now <code>WikidataLoader.load_item(qid)</code> (old method still works but is deprecated)</li>
<li><code>strip_entity_identifiers()</code> now also removes <code>ns</code> and <code>title</code> fields</li>
<li>New batch loading: <code>load_items()</code>, <code>load_properties()</code></li>
<li>New entity types: <code>load_property()</code>, <code>load_entity_schema()</code></li>
<li>Transformation methods moved to template objects: <code>template.to_shell()</code>, <code>template.to_qsv1()</code></li>
</ul>
<hr />
<h2 id="see-also">See Also</h2>
<ul>
<li><a href="../../cli/mash/">Mash CLI</a> - Command-line interface for mash operations</li>
<li><a href="../mash_formatters/">Mash Formatters API</a> - Convert templates to output formats</li>
<li>Recipe API - Build validation recipes from EntitySchemas</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.instant", "navigation.sections", "navigation.top", "toc.follow"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../../javascripts/mermaid-init.js"></script>
      
    
  </body>
</html>